{
  "upsertObjectControl": "MERGE [@BYB_T1ITR100] as T0  using (select 'BALTER' as  [U_ReportType]) as S1  ( [U_ReportType])  on (T0.[U_ReportType] = S1.[U_ReportType])  when matched then update set T0.[U_LastTrans] = [--LastTrans--], T0.[U_LastDate] = getdate()  when not matched then insert([Code], [Name], [DocEntry], [U_LastDate], [U_LastTrans], [U_ReportType] ) values(newid(), newid(), (coalesce((select max(DocEntry) from [@BYB_T1ITR100]),0)+1),getdate(),[--LastTrans--],'BALTER');",
  "getObjectControl": "select Code, Name, DocEntry, U_TransType, U_LastDate, U_LastTrans from[@BYB_T1ITR100] where U_LastDate < convert(datetime,'[--LastDate--]',112)",
  "getTransactionList": "select distinct TransId from OJDT where TransId > coalesce((select distinct U_LastTrans from [@BYB_T1ITR100]),-1) order by TransId ASC",
  "reportType": "BALTER",
  "UpsertCurrentBalance": "MERGE  [@BYB_T1ITR101] as T0  using (select '[--Account--]' as [U_Account], [--Level--] as [U_Level] ,[--Year--] as [U_Year],[--Month--] as [U_Month],[--Day--] as [U_Day] ,'[--DateType--]' as [U_DateType],'[--ThirdParty--]' as [U_ThirdParty],'[--DIM1--]' as [U_DIM1] ,'[--DIM2--]' as [U_DIM2],'[--DIM3--]' as [U_DIM3],'[--DIM4--]' as [U_DIM4],'[--DIM5--]' as [U_DIM5]) as S1 ( [U_Account], [U_Level], [U_Year], [U_Month], [U_Day], [U_DateType], [U_ThirdParty], [U_DIM1], [U_DIM2], [U_DIM3], [U_DIM4], [U_DIM5]) ON (T0.[U_Account]=S1.[U_Account] and T0.[U_Level] = S1.[U_Level] and T0.[U_Year]=S1.[U_Year] and T0.[U_Month]=S1.[U_Month] and T0.[U_Day]=S1.[U_Day] and T0.[U_DateType] =S1.[U_DateType] and T0.[U_ThirdParty] =S1.[U_ThirdParty] and T0.[U_DIM1] =S1.[U_DIM1] and T0.[U_DIM2] =S1.[U_DIM2] and T0.[U_DIM3]=S1.[U_DIM3] and T0.[U_DIM4] =S1.[U_DIM4] and T0.[U_DIM5] =S1.[U_DIM5])  when matched then update set T0.[U_Debit] += [--Debit--], T0.[U_Credit] += [--Credit--], T0.[U_CurrBalance] += [--CurrBalance--]  when not matched then insert( [Code], [Name], [DocEntry], [U_Account], [U_Level], [U_Year], [U_Month], [U_Day], [U_DateType], [U_CurrBalance], [U_ThirdParty], [U_TransCode], [U_Debit], [U_Credit], [U_DIM1], [U_DIM2], [U_DIM3], [U_DIM4], [U_DIM5] ) values (newid(),newid(),(coalesce((select max(DocEntry) from [@BYB_T1ITR101]),0)+1),S1.[U_Account] ,S1.[U_Level],S1.[U_Year] ,S1.[U_Month],S1.[U_Day],S1.[U_DateType],[--CurrBalance--],'[--ThirdParty--]','[--TransCode--]',[--Debit--],[--Credit--] ,S1.[U_DIM1],S1.[U_DIM2],S1.[U_DIM3],S1.[U_DIM4],S1.[U_DIM5]);"
}